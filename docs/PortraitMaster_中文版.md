# Documentation
- Class name: PortraitMaster_ä¸­æ–‡ç‰ˆ
- Category: ğŸ“¸è‚–åƒå¤§å¸ˆ
- Output node: False
- Repo Ref: https://github.com/ZHO-ZHO-ZHO/comfyui-portrait-master-zh-cn

è¯¥èŠ‚ç‚¹æ—¨åœ¨æ ¹æ®å¤šç§å¯å®šåˆ¶å‚æ•°ç”Ÿæˆè¯¦ç»†çš„è‚–åƒç”Ÿæˆæç¤ºã€‚å®ƒæ—¨åœ¨ä¸ºç”¨æˆ·æä¾›ä¸€å¥—å…¨é¢çš„é€‰é¡¹æ¥å¾®è°ƒç”Ÿæˆè¿‡ç¨‹ï¼Œä»è€Œå®ç°é«˜åº¦ä¸ªæ€§åŒ–å’ŒçœŸå®çš„è‚–åƒåˆ›ä½œã€‚

# Input types
## Required
- é•œå¤´ç±»å‹
    - è¯¥å‚æ•°å†³å®šäº†ç”Ÿæˆè‚–åƒçš„é•œå¤´ç±»å‹æˆ–è§†è§’ã€‚å®ƒåœ¨è®¾ç½®åœºæ™¯å’Œè‚–åƒæ¡†æ¶ä¸­è‡³å…³é‡è¦ï¼Œä»è€Œæ˜¾è‘—å½±å“æœ€ç»ˆçš„è§†è§‰ç»“æœã€‚
    - Comfy dtype: COMBO[string]
    - Python dtype: str
- æ€§åˆ«
    - æ€§åˆ«å‚æ•°åœ¨ç¡®å®šè‚–åƒä¸»é¢˜çš„ç‰©ç†ç‰¹å¾å’Œæ•´ä½“å¤–è§‚æ–¹é¢è‡³å…³é‡è¦ã€‚å®ƒæŒ‡å¯¼ç”Ÿæˆè¿‡ç¨‹äº§ç”Ÿç¬¦åˆæŒ‡å®šæ€§åˆ«çš„ä¸»é¢˜ã€‚
    - Comfy dtype: COMBO[string]
    - Python dtype: str
- å¹´é¾„
    - å¹´é¾„åœ¨å¡‘é€ è‚–åƒçš„é¢éƒ¨ç‰¹å¾å’Œçš®è‚¤ç»†èŠ‚æ–¹é¢èµ·ç€é‡è¦ä½œç”¨ã€‚å®ƒæœ‰åŠ©äºç”Ÿæˆå…·æœ‰çœŸå®å¹´é¾„ç‰¹å¾çš„ä¸»é¢˜ï¼Œç¡®ä¿æç»˜çš„çœŸå®æ€§ã€‚
    - Comfy dtype: INT
    - Python dtype: int
- å›½ç±_1
    - ç¬¬ä¸€ä¸ªå›½ç±å‚æ•°æœ‰åŠ©äºè‚–åƒä¸»é¢˜çš„æ–‡åŒ–å’Œç§æ—èƒŒæ™¯ï¼Œå½±å“é€‰æ‹©åæ˜ ç‰¹å®šå›½ç±çš„ç‰¹å¾ã€‚
    - Comfy dtype: COMBO[string]
    - Python dtype: str
- å›½ç±_2
    - ç¬¬äºŒä¸ªå›½ç±å‚æ•°ä¸ç¬¬ä¸€ä¸ªç»“åˆä½¿ç”¨æ—¶ï¼Œå…è®¸ä»ä¸¤ç§ä¸åŒçš„å›½ç±ä¸­æ··åˆç‰¹å¾ï¼Œä¸ºè‚–åƒå¢æ·»å¤šæ ·æ€§å’Œå¤æ‚æ€§ã€‚
    - Comfy dtype: COMBO[string]
    - Python dtype: str
- å›½ç±æ··åˆ
    - è¯¥å‚æ•°è°ƒæ•´ä¸¤ä¸ªå›½ç±çš„æ··åˆæ¯”ä¾‹ï¼Œç¡®ä¿æœ€ç»ˆè‚–åƒåæ˜ å‡ºæ‰€é€‰ç§æ—ç‰¹å¾çš„å¾®å¦™å¹³è¡¡ã€‚
    - Comfy dtype: FLOAT
    - Python dtype: float

# Output types
- positive
    - æ­£é¢è¾“å‡ºæ˜¯ä¸€ä¸ªè¯¦ç»†çš„æç¤ºï¼ŒåŒ…å«äº†æ‰€æœ‰è¾“å…¥å‚æ•°ï¼Œä½œä¸ºç”Ÿæˆè‚–åƒè¿‡ç¨‹çš„æŒ‡å—ã€‚å®ƒæ˜¯è‡³å…³é‡è¦çš„ç»„æˆéƒ¨åˆ†ï¼Œå› ä¸ºå®ƒç›´æ¥å½±å“æœ€ç»ˆç»“æœã€‚
    - Comfy dtype: STRING
    - Python dtype: str
- negative
    - è´Ÿé¢è¾“å‡ºåŒ…å«ä¸€ç»„æ—¨åœ¨ä»è‚–åƒç”Ÿæˆä¸­æ’é™¤çš„æç¤ºã€‚å®ƒé€šè¿‡é˜²æ­¢ä¸éœ€è¦çš„ç‰¹å¾æˆ–é£æ ¼è¢«åŒ…å«ï¼Œæœ‰åŠ©äºå®Œå–„æœ€ç»ˆè¾“å‡ºã€‚
    - Comfy dtype: STRING
    - Python dtype: str

# Usage tips
- Infra type: CPU

# Source code
```
class PortraitMaster_ä¸­æ–‡ç‰ˆ:

    def __init__(self):
        pass

    @classmethod
    def INPUT_TYPES(self):
        p = os.path.dirname(os.path.realpath(__file__))
        shot_file_path = os.path.join(p, 'lists/shot_list.json')
        gender_file_path = os.path.join(p, 'lists/gender_list.json')
        eyes_color_file_path = os.path.join(p, 'lists/eyes_color_list.json')
        face_shape_file_path = os.path.join(p, 'lists/face_shape_list.json')
        facial_expressions_file_path = os.path.join(p, 'lists/face_expression_list.json')
        nationality_file_path = os.path.join(p, 'lists/nationality_list.json')
        hair_style_file_path = os.path.join(p, 'lists/hair_style_list.json')
        hair_color_file_path = os.path.join(p, 'lists/hair_color_list.json')
        light_type_file_path = os.path.join(p, 'lists/light_type_list.json')
        light_direction_file_path = os.path.join(p, 'lists/light_direction_list.json')
        body_type_file_path = os.path.join(p, 'lists/body_type_list.json')
        beard_file_path = os.path.join(p, 'lists/beard_list.json')
        model_pose_file_path = os.path.join(p, 'lists/model_pose_list.json')
        self.shot_data = read_json_file(shot_file_path)
        self.gender_data = read_json_file(gender_file_path)
        self.eyes_color_data = read_json_file(eyes_color_file_path)
        self.face_shape_data = read_json_file(face_shape_file_path)
        self.facial_expressions_data = read_json_file(facial_expressions_file_path)
        self.nationality_data = read_json_file(nationality_file_path)
        self.hair_style_data = read_json_file(hair_style_file_path)
        self.hair_color_data = read_json_file(hair_color_file_path)
        self.light_type_data = read_json_file(light_type_file_path)
        self.light_direction_data = read_json_file(light_direction_file_path)
        self.body_type_data = read_json_file(body_type_file_path)
        self.beard_data = read_json_file(beard_file_path)
        self.model_pose_data = read_json_file(model_pose_file_path)
        shot_list = get_name(self.shot_data)
        shot_list = ['-'] + shot_list
        gender_list = get_name(self.gender_data)
        gender_list = ['-'] + gender_list
        eyes_color_list = get_name(self.eyes_color_data)
        eyes_color_list = ['-'] + eyes_color_list
        face_shape_list = get_name(self.face_shape_data)
        face_shape_list = ['-'] + face_shape_list
        facial_expressions_list = get_name(self.facial_expressions_data)
        facial_expressions_list = ['-'] + facial_expressions_list
        nationality_list = get_name(self.nationality_data)
        nationality_list = ['-'] + nationality_list
        hair_style_list = get_name(self.hair_style_data)
        hair_style_list = ['-'] + hair_style_list
        hair_color_list = get_name(self.hair_color_data)
        hair_color_list = ['-'] + hair_color_list
        light_type_list = get_name(self.light_type_data)
        light_type_list = ['-'] + light_type_list
        light_direction_list = get_name(self.light_direction_data)
        light_direction_list = ['-'] + light_direction_list
        body_type_list = get_name(self.body_type_data)
        body_type_list = ['-'] + body_type_list
        beard_list = get_name(self.beard_data)
        beard_list = ['-'] + beard_list
        model_pose_list = get_name(self.model_pose_data)
        model_pose_list = ['-'] + model_pose_list
        max_float_value = 1.75
        return {'required': {'é•œå¤´ç±»å‹': (shot_list, {'default': shot_list[0]}), 'é•œå¤´æƒé‡': ('FLOAT', {'default': 1.5, 'step': 0.05, 'min': 0, 'max': max_float_value, 'display': 'slider'}), 'æ€§åˆ«': (gender_list, {'default': gender_list[0]}), 'å¹´é¾„': ('INT', {'default': 20, 'min': 18, 'max': 90, 'step': 1, 'display': 'slider'}), 'å›½ç±_1': (nationality_list, {'default': nationality_list[0]}), 'å›½ç±_2': (nationality_list, {'default': nationality_list[0]}), 'å›½ç±æ··åˆ': ('FLOAT', {'default': 0.5, 'min': 0, 'max': 1, 'step': 0.05, 'display': 'slider'}), 'ä½“å‹': (body_type_list, {'default': body_type_list[0]}), 'ä½“å‹æƒé‡': ('FLOAT', {'default': 0, 'step': 0.05, 'min': 0, 'max': max_float_value, 'display': 'slider'}), 'å§¿åŠ¿': (model_pose_list, {'default': model_pose_list[0]}), 'çœ¼ç›é¢œè‰²': (eyes_color_list, {'default': eyes_color_list[0]}), 'é¢éƒ¨è¡¨æƒ…': (facial_expressions_list, {'default': facial_expressions_list[0]}), 'é¢éƒ¨è¡¨æƒ…æƒé‡': ('FLOAT', {'default': 1.5, 'step': 0.05, 'min': 0, 'max': max_float_value, 'display': 'slider'}), 'è„¸å‹': (face_shape_list, {'default': face_shape_list[0]}), 'è„¸å‹æƒé‡': ('FLOAT', {'default': 1, 'step': 0.05, 'min': 0, 'max': max_float_value, 'display': 'slider'}), 'é¢éƒ¨å¯¹ç§°æ€§': ('FLOAT', {'default': 0.2, 'min': 0, 'max': max_float_value, 'step': 0.05, 'display': 'slider'}), 'å‘å‹': (hair_style_list, {'default': hair_style_list[0]}), 'å¤´å‘é¢œè‰²': (hair_color_list, {'default': hair_color_list[0]}), 'å¤´å‘è“¬æ¾åº¦': ('FLOAT', {'default': 1, 'min': 0, 'max': max_float_value, 'step': 0.05, 'display': 'slider'}), 'èƒ¡å­': (beard_list, {'default': beard_list[0]}), 'çš®è‚¤ç»†èŠ‚': ('FLOAT', {'default': 0.5, 'min': 0, 'max': max_float_value, 'step': 0.05, 'display': 'slider'}), 'çš®è‚¤æ¯›å­”': ('FLOAT', {'default': 0.3, 'min': 0, 'max': max_float_value, 'step': 0.05, 'display': 'slider'}), 'é…’çª': ('FLOAT', {'default': 0, 'min': 0, 'max': max_float_value, 'step': 0.05, 'display': 'slider'}), 'çš±çº¹': ('FLOAT', {'default': 0, 'min': 0, 'max': max_float_value, 'step': 0.05, 'display': 'slider'}), 'é›€æ–‘': ('FLOAT', {'default': 0, 'min': 0, 'max': max_float_value, 'step': 0.05, 'display': 'slider'}), 'ç—£': ('FLOAT', {'default': 0, 'min': 0, 'max': max_float_value, 'step': 0.05, 'display': 'slider'}), 'çš®è‚¤ç‘•ç–µ': ('FLOAT', {'default': 0, 'min': 0, 'max': max_float_value, 'step': 0.05, 'display': 'slider'}), 'ç—˜ç—˜': ('FLOAT', {'default': 0, 'min': 0, 'max': max_float_value, 'step': 0.05, 'display': 'slider'}), 'å°éº¦è‰²è‚¤è‰²': ('FLOAT', {'default': 0, 'min': 0, 'max': max_float_value, 'step': 0.05, 'display': 'slider'}), 'çœ¼ç›ç»†èŠ‚': ('FLOAT', {'default': 1.2, 'min': 0, 'max': max_float_value, 'step': 0.05, 'display': 'slider'}), 'è™¹è†œç»†èŠ‚': ('FLOAT', {'default': 1.2, 'min': 0, 'max': max_float_value, 'step': 0.05, 'display': 'slider'}), 'åœ†å½¢è™¹è†œ': ('FLOAT', {'default': 1.2, 'min': 0, 'max': max_float_value, 'step': 0.05, 'display': 'slider'}), 'åœ†å½¢ç³å­”': ('FLOAT', {'default': 1.2, 'min': 0, 'max': max_float_value, 'step': 0.05, 'display': 'slider'}), 'ç¯å…‰ç±»å‹': (light_type_list, {'default': light_type_list[0]}), 'ç¯å…‰æ–¹å‘': (light_direction_list, {'default': light_direction_list[0]}), 'ç¯å…‰æƒé‡': ('FLOAT', {'default': 1.2, 'min': 0, 'max': max_float_value, 'step': 0.05, 'display': 'slider'}), 'æé«˜ç…§ç‰‡çœŸå®æ„Ÿ': (['enable', 'disable'],), 'èµ·å§‹æç¤ºè¯': ('STRING', {'multiline': True, 'default': 'raw photo, (realistic:1.5)'}), 'è¡¥å……æç¤ºè¯': ('STRING', {'multiline': True, 'default': '(white background:1.5)'}), 'ç»“æŸæç¤ºè¯': ('STRING', {'multiline': True, 'default': ''}), 'è´Ÿé¢æç¤ºè¯': ('STRING', {'multiline': True, 'default': ''})}}
    RETURN_TYPES = ('STRING', 'STRING')
    RETURN_NAMES = ('positive', 'negative')
    FUNCTION = 'pm'
    CATEGORY = 'ğŸ“¸è‚–åƒå¤§å¸ˆ'

    def pm(self, é•œå¤´ç±»å‹='-', é•œå¤´æƒé‡=1, æ€§åˆ«='-', ä½“å‹='-', ä½“å‹æƒé‡=0, çœ¼ç›é¢œè‰²='-', é¢éƒ¨è¡¨æƒ…='-', é¢éƒ¨è¡¨æƒ…æƒé‡=0, è„¸å‹='-', è„¸å‹æƒé‡=0, å›½ç±_1='-', å›½ç±_2='-', å›½ç±æ··åˆ=0.5, å¹´é¾„=20, å‘å‹='-', å¤´å‘é¢œè‰²='-', å¤´å‘è“¬æ¾åº¦=0, é…’çª=0, é›€æ–‘=0, çš®è‚¤æ¯›å­”=0, çš®è‚¤ç»†èŠ‚=0, ç—£=0, çš®è‚¤ç‘•ç–µ=0, çš±çº¹=0, å°éº¦è‰²è‚¤è‰²=0, çœ¼ç›ç»†èŠ‚=1, è™¹è†œç»†èŠ‚=1, åœ†å½¢è™¹è†œ=1, åœ†å½¢ç³å­”=1, é¢éƒ¨å¯¹ç§°æ€§=0, è¡¥å……æç¤ºè¯='', èµ·å§‹æç¤ºè¯='', ç»“æŸæç¤ºè¯='', ç¯å…‰ç±»å‹='-', ç¯å…‰æ–¹å‘='-', ç¯å…‰æƒé‡=0, è´Ÿé¢æç¤ºè¯='', æé«˜ç…§ç‰‡çœŸå®æ„Ÿ='disable', èƒ¡å­='-', å§¿åŠ¿='-', ç—˜ç—˜=0):
        shot = get_prompt(self.shot_data, é•œå¤´ç±»å‹)
        gender = get_prompt(self.gender_data, æ€§åˆ«)
        eyes_color = get_prompt(self.eyes_color_data, çœ¼ç›é¢œè‰²)
        face_shape = get_prompt(self.face_shape_data, è„¸å‹)
        facial_expressions = get_prompt(self.facial_expressions_data, é¢éƒ¨è¡¨æƒ…)
        nationality_1 = get_prompt(self.nationality_data, å›½ç±_1)
        nationality_2 = get_prompt(self.nationality_data, å›½ç±_2)
        hair_style = get_prompt(self.hair_style_data, å‘å‹)
        hair_color = get_prompt(self.hair_color_data, å¤´å‘é¢œè‰²)
        light_type = get_prompt(self.light_type_data, ç¯å…‰ç±»å‹)
        light_direction = get_prompt(self.light_direction_data, ç¯å…‰æ–¹å‘)
        body_type = get_prompt(self.body_type_data, ä½“å‹)
        beard = get_prompt(self.beard_data, èƒ¡å­)
        model_pose = get_prompt(self.model_pose_data, å§¿åŠ¿)
        prompt = []
        if æ€§åˆ« == '-':
            æ€§åˆ« = ''
        else:
            æ€§åˆ« = ' ' + gender + ' '
        if å›½ç±_1 != '-' and å›½ç±_2 != '-':
            Anationality = f'[{nationality_1}:{nationality_2}:{round(å›½ç±æ··åˆ, 2)}]'
        elif å›½ç±_1 != '-':
            Anationality = nationality_1 + ' '
        elif å›½ç±_2 != '-':
            Anationality = nationality_2 + ' '
        else:
            Anationality = ''
        if èµ·å§‹æç¤ºè¯ != '':
            prompt.append(f'{èµ·å§‹æç¤ºè¯}')
        if é•œå¤´ç±»å‹ != '-' and é•œå¤´æƒé‡ > 0:
            prompt.append(f'({shot}:{round(é•œå¤´æƒé‡, 2)})')
        prompt.append(f'({Anationality}{æ€§åˆ«}{round(å¹´é¾„)}-years-old:1.5)')
        if ä½“å‹ != '-' and ä½“å‹æƒé‡ > 0:
            prompt.append(f'({body_type}, {body_type} body:{round(ä½“å‹æƒé‡, 2)})')
        if å§¿åŠ¿ != '-':
            prompt.append(f'({model_pose}:1.5)')
        if çœ¼ç›é¢œè‰² != '-':
            prompt.append(f'({eyes_color} eyes:1.25)')
        if é¢éƒ¨è¡¨æƒ… != '-' and é¢éƒ¨è¡¨æƒ…æƒé‡ > 0:
            prompt.append(f'({facial_expressions}, {facial_expressions} expression:{round(é¢éƒ¨è¡¨æƒ…æƒé‡, 2)})')
        if è„¸å‹ != '-' and è„¸å‹æƒé‡ > 0:
            prompt.append(f'({face_shape} shape face:{round(è„¸å‹æƒé‡, 2)})')
        if å‘å‹ != '-':
            prompt.append(f'({hair_style} hairstyle:1.25)')
        if å¤´å‘é¢œè‰² != '-':
            prompt.append(f'({hair_color} hair:1.25)')
        if èƒ¡å­ != '-':
            prompt.append(f'({beard}:1.15)')
        if å¤´å‘è“¬æ¾åº¦ != '-':
            prompt.append(f'(disheveled:{round(å¤´å‘è“¬æ¾åº¦, 2)})')
        if è¡¥å……æç¤ºè¯ != '':
            prompt.append(f'{è¡¥å……æç¤ºè¯}')
        if çš®è‚¤ç»†èŠ‚ > 0:
            prompt.append(f'(skin details, skin texture:{round(çš®è‚¤ç»†èŠ‚, 2)})')
        if çš®è‚¤æ¯›å­” > 0:
            prompt.append(f'(skin pores:{round(çš®è‚¤æ¯›å­”, 2)})')
        if çš®è‚¤ç‘•ç–µ > 0:
            prompt.append(f'(skin imperfections:{round(çš®è‚¤ç‘•ç–µ, 2)})')
        if ç—˜ç—˜ > 0:
            prompt.append(f'(acne, skin with acne:{round(ç—˜ç—˜, 2)})')
        if çš±çº¹ > 0:
            prompt.append(f'(skin imperfections:{round(çš±çº¹, 2)})')
        if å°éº¦è‰²è‚¤è‰² > 0:
            prompt.append(f'(tanned skin:{round(å°éº¦è‰²è‚¤è‰², 2)})')
        if é…’çª > 0:
            prompt.append(f'(dimples:{round(é…’çª, 2)})')
        if é›€æ–‘ > 0:
            prompt.append(f'(freckles:{round(é›€æ–‘, 2)})')
        if ç—£ > 0:
            prompt.append(f'(skin pores:{round(ç—£, 2)})')
        if çœ¼ç›ç»†èŠ‚ > 0:
            prompt.append(f'(eyes details:{round(çœ¼ç›ç»†èŠ‚, 2)})')
        if è™¹è†œç»†èŠ‚ > 0:
            prompt.append(f'(iris details:{round(è™¹è†œç»†èŠ‚, 2)})')
        if åœ†å½¢è™¹è†œ > 0:
            prompt.append(f'(circular iris:{round(åœ†å½¢è™¹è†œ, 2)})')
        if åœ†å½¢ç³å­” > 0:
            prompt.append(f'(circular pupil:{round(åœ†å½¢ç³å­”, 2)})')
        if é¢éƒ¨å¯¹ç§°æ€§ > 0:
            prompt.append(f'(facial asymmetry, face asymmetry:{round(é¢éƒ¨å¯¹ç§°æ€§, 2)})')
        if ç¯å…‰ç±»å‹ != '-' and ç¯å…‰æƒé‡ > 0:
            if ç¯å…‰æ–¹å‘ != '-':
                prompt.append(f'({light_type} {light_direction}:{round(ç¯å…‰æƒé‡, 2)})')
            else:
                prompt.append(f'({light_type}:{round(ç¯å…‰æƒé‡, 2)})')
        if ç»“æŸæç¤ºè¯ != '':
            prompt.append(f'{ç»“æŸæç¤ºè¯}')
        prompt = ', '.join(prompt)
        prompt = prompt.lower()
        if æé«˜ç…§ç‰‡çœŸå®æ„Ÿ == 'enable':
            prompt = prompt + ', (detailed, professional photo, perfect exposition:1.25), (film grain:1.5)'
        if æé«˜ç…§ç‰‡çœŸå®æ„Ÿ == 'enable':
            negative_prompt = è´Ÿé¢æç¤ºè¯ + ', (shinny skin, reflections on the skin, skin reflections:1.5)'
        else:
            negative_prompt = è´Ÿé¢æç¤ºè¯
        print('Portrait Master as generate the prompt:')
        print(prompt)
        return (prompt, negative_prompt)
```